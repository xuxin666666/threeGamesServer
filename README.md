# threeGames接口文档

**URL: 127.0.0.1:8000/**

## 1. 接口说明

- 接口的基准地址：`http://127.0.0.1:8000/`
- 服务端已开启 CORS 跨域支持
- 使用 Token 认证
- 需要授权的 API，必须在请求头中使用 `Authorization` 字段提供 `token` 令牌
- 数据请求和数据返回，格式统一使用 JSON

### 1.1 支持的请求方法

- GET
- POST

### 1.2 通用返回状态说明

| 状态码 | 含义                | 说明                       |
| ------ | ------------------- | :------------------------- |
| 200    | OK                  | 请求成功                   |
| 401    | Not Login           | 未登录                     |
| 412    | Invalid Params      | 参数有误                   |
| 430    | active token failed | token失效                  |
| 500    | ServerBusy          | 服务繁忙（服务端出现错误） |

## 2. 用户

### 2.1 注册新用户

- 请求路径：`/auth/register`
- 请求方法：POST
- 请求参数

| 参数名   | 参数类型 | 参数说明 | 备注     |
| -------- | -------- | -------- | -------- |
| username | string   | 用户名   | 不能为空 |
| password | string   | 密码     | 不能为空 |
| avatar   | string   | 头像     | 不能为空 |

- 响应参数

	无

- 响应数据示例

```json
{
    "status": 200,
    "msg": "请求成功",
    "data": null
}
```

### 2.2 登录

- 请求路径：`/auth`
- 请求方法：POST
- 请求参数

| 参数名     | 参数类型 | 参数说明     | 备注     |
| ---------- | -------- | ------------ | -------- |
| username   | string   | 用户名       | 不能为空 |
| password   | string   | 密码         | 不能为空 |
| auto_login | bool     | 是否自动登录 | 不能为空 |

- 响应参数

| 参数名 | 参数类型 | 参数说明 | 备注            |
| ------ | -------- | -------- | --------------- |
| avatar | string   | 头像     |                 |
| token  | string   | 令牌     | 基于 jwt 的令牌 |

- 响应数据示例

```json
{
    "status": 200,
    "msg": "请求成功",
    "data": {
        "avatar": "123456",
        "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoyMTU3MTg0Mzg1NzA1OTg0MCwidXNlcm5hbWUiOiJ1c2VyMSIsImV4cCI6MTYzODQ1ODIzOSwiaXNzIjoiYmx1ZWJlbGwifQ.RHhogQVjz_vb_LHn0VMiJjo2l9rQys8s2JMOM3lUYjY"
    }
}
```

### 2.3 自动登录

- 请求路径：`/auth/auto`
- 请求方法：GET
- 响应参数

| 参数名   | 参数类型 | 参数说明 | 备注 |
| -------- | -------- | -------- | ---- |
| username | string   | 用户名   |      |
| avatar   | string   | 头像     |      |

- 响应数据示例

```json
{
    "status": 200,
    "msg": "请求成功",
    "data": {
        "username": "user1",
        "avatar": "123456"
    }
}
```

### 2.4 更改头像

- 请求路径：`/auth/changeAvatar`
- 请求方法：POST
- 请求参数

| 参数名 | 参数类型 | 参数说明 | 备注     |
| ------ | -------- | -------- | -------- |
| avatar | string   | 头像     | 不能为空 |

- 响应参数

	无

- 响应数据示例

```json
{
    "status": 200,
    "msg": "请求成功",
    "data": null
}
```

## 3. 俄罗斯方块

### 3.1 获取分数

- 请求路径：`/tetris`
- 请求方法：GET
- 响应参数

| 参数名 | 参数类型 | 参数说明 | 备注                                                         |
| ------ | -------- | -------- | ------------------------------------------------------------ |
| scores | string   | 分数     | 得分用 `` ``` `` 分隔，每个得分的分数和时间戳用 `` ` `` 分隔 |

- 响应数据示例

```json
{
    "status": 200,
    "msg": "请求成功",
    "data": {
        "scores": "12322`1638533563115```12322`1638533564008```12322`1638533564485```12322`1638533564866```12322`1638533565243```"
    }
}
```

### 3.2 上传单个分数

- 请求路径：`/tetris/postScores`
- 请求方法：POST
- 请求参数

| 参数名 | 参数类型 | 参数说明 | 备注     |
| ------ | -------- | -------- | -------- |
| scores | int      | 得分     | 不能为空 |

- 响应参数

	无

### 3.3 上传多组分数

- 请求路径：`/tetris/postScores/list`
- 请求方法：POST
- 请求参数

| 参数名 | 参数类型 | 参数说明 | 备注                                                         |
| ------ | -------- | -------- | ------------------------------------------------------------ |
| scores | string   | 得分     | 用 `` ``` `` 分隔，每个得分的分数和时间戳用 `` ` `` 分隔，不能为空 |

- 响应参数

| 参数名 | 参数类型 | 参数说明 | 备注                                                         |
| ------ | -------- | -------- | ------------------------------------------------------------ |
| scores | string   | 分数     | 得分用 `` ``` `` 分隔，每个得分的分数和时间戳用 `` ` `` 分隔 |

- 响应数据示例
	
```json
	{
	    "status": 200,
	    "msg": "请求成功",
	    "data": {
	        "scores": "12322`1638533563115```12322`1638533564008```12322`1638533564485```12322`1638533564866```12322`1638533565243```"
	    }
	}
```

## 4. 扫雷

### 4.1 获取分数

- 请求路径：`/mineSweep`
- 请求方法：GET
- 响应参数

| 参数名 | 参数类型 | 参数说明 | 备注                                                         |
| ------ | -------- | -------- | ------------------------------------------------------------ |
| scores | string   | 分数     | 得分用 `` ``` `` 分隔，每个得分的分数和时间戳用 `` ` `` 分隔 |

- 响应数据示例

```json
{
    "status": 200,
    "msg": "请求成功",
    "data": {
        "scores": "12322`1638533563115```12322`1638533564008```12322`1638533564485```12322`1638533564866```12322`1638533565243```"
    }
}
```

### 4.2 上传分数

- 请求路径：`/mineSweep/postScores`
- 请求方法：POST
- 请求参数

| 参数名 | 参数类型 | 参数说明 | 备注     |
| ------ | -------- | -------- | -------- |
| scores | int      | 得分     | 不能为空 |

- 响应参数

	无

### 4.3 上传多组分数

- 请求路径：`/mineSweep/postScores/list`
- 请求方法：POST
- 请求参数

| 参数名 | 参数类型 | 参数说明 | 备注                                                         |
| ------ | -------- | -------- | ------------------------------------------------------------ |
| scores | string   | 得分     | 用 `` ``` `` 分隔，每个得分的分数和时间戳用 `` ` `` 分隔，不能为空 |

- 响应参数

| 参数名 | 参数类型 | 参数说明 | 备注                                                         |
| ------ | -------- | -------- | ------------------------------------------------------------ |
| scores | string   | 分数     | 得分用 `` ``` `` 分隔，每个得分的分数和时间戳用 `` ` `` 分隔 |

- 响应数据示例

```json
	{
	    "status": 200,
	    "msg": "请求成功",
	    "data": {
	        "scores": "12322`1638533563115```12322`1638533564008```12322`1638533564485```12322`1638533564866```12322`1638533565243```"
	    }
	}
```

## 5. 社区

### 5.1 创建帖子

- 请求路径：`/community/createPage`
- 请求方法：POST
- 请求参数

| 参数名  | 参数类型 | 参数说明 | 备注     |
| ------- | -------- | -------- | -------- |
| title   | string   | 帖子标题 | 不能为空 |
| content | string   | 帖子正文 | 不能为空 |

- 响应参数

| 参数名       | 参数类型 | 参数说明 | 备注                                    |
| ------------ | -------- | -------- | --------------------------------------- |
| views        | int      | 浏览数   |                                         |
| comments_num | int      | 评论总数 | 包括该帖子下的所有评论和回复            |
| page_id      | string   | 帖子ID   |                                         |
| username     | string   | 用户名   | 创建帖子的人的用户名                    |
| userAvatar   | string   | 头像     | 创建帖子的人的头像                      |
| title        | string   | 帖子标题 |                                         |
| content      | string   | 帖子正文 |                                         |
| approve      | string   | 点赞者   | 用 `,` 分隔的用户名，表示这些人都点了赞 |
| create_time  | int      | 创建日期 | 时间戳                                  |
| update_time  | int      | 修改日期 | 时间戳                                  |

- 响应数据示例

```json
{
    "status": 200,
    "msg": "请求成功",
    "data": {
        "views": 0,
        "page_id": "22253249130139648",
        "comments_num": 0,
        "user_avatar": "123456",
        "title": "大家好啊",
        "content": "今天也不错哦",
        "approve": "",
        "create_time": "2021-12-01T17:46:28+08:00",
        "update_time": "2021-12-01T17:46:28+08:00"
    }
}
```

### 5.2 获取帖子列表

- 请求路径：`/community`
- 请求方法：POST
- 请求参数

| 参数名 | 参数类型 | 参数说明         | 备注                 |
| ------ | -------- | ---------------- | -------------------- |
| start  | int      | 从第几个帖子开始 | 初始为1，不能为空    |
| length | int      | 请求的帖子数     | 不能大于20，不能为空 |

- 响应参数

| 参数名       | 参数类型 | 参数说明     | 备注                                    |
| ------------ | -------- | ------------ | --------------------------------------- |
| views        | int      | 浏览数       |                                         |
| comments_num | int      | 评论总数     | 包括该帖子下的所有评论和回复            |
| page_id      | string   | 帖子ID       |                                         |
| username     | string   | 用户名       | 创建帖子的人的用户名                    |
| user_avatar  | string   | 头像         | 创建帖子的人的头像                      |
| title        | string   | 帖子标题     |                                         |
| pre_content  | string   | 帖子正文预览 |                                         |
| approve      | string   | 点赞者       | 用 `,` 分隔的用户名，表示这些人都点了赞 |
| create_time  | int      | 创建日期     | 时间戳                                  |

- 响应数据示例

```json
{
    "status": 200,
    "msg": "请求成功",
    "data": [
        {
            "views": 1,
            "comments_num": 0,
            "create_time": 1638534090218,
            "page_id": "23017041032122368",
            "username": "user1",
            "user_avatar": "123456",
            "title": "大家好啊",
            "pre_content": "今天也不错哦",
            "approve": ""
        },
        {
            "views": 1,
            "comments_num": 0,
            "create_time": 1638534035275,
            "page_id": "23016810584477696",
            "username": "user1",
            "user_avatar": "123456",
            "title": "大家好啊",
            "pre_content": "今天也不错哦",
            "approve": ""
        },
        {
            "views": 1,
            "comments_num": 0,
            "create_time": 1638534032674,
            "page_id": "23016799675092992",
            "username": "user1",
            "user_avatar": "123456",
            "title": "大家好啊",
            "pre_content": "今天也不错哦",
            "approve": ""
        },
        {
            "views": 0,
            "comments_num": 0,
            "create_time": 1638533893033,
            "page_id": "23016213978288128",
            "username": "user1",
            "user_avatar": "123456",
            "title": "大家好啊",
            "pre_content": "今天也不错哦",
            "approve": ""
        }
    ]
}
```

### 5.3 获取帖子详情

- 请求路径：`/community/:page_id`
- 请求方法：GET
- 响应参数

| 参数名       | 参数类型 | 参数说明 | 备注                                    |
| ------------ | -------- | -------- | --------------------------------------- |
| views        | int      | 浏览数   |                                         |
| comments_num | int      | 评论数   |                                         |
| page_id      | string   | 帖子的id |                                         |
| username     | string   | 用户名   |                                         |
| user_avatar  | string   | 用户头像 |                                         |
| title        | string   | 帖子标题 |                                         |
| content      | string   | 帖子内容 |                                         |
| approve      | string   | 点赞者   | 用 `,` 分隔的用户名，表示这些人都点了赞 |
| create_time  | int      | 创建日期 | 时间戳                                  |
| update_time  | int      | 修改日期 | 时间戳                                  |

- 响应数据示例

```json
{
    "status": 200,
    "msg": "请求成功",
    "data": {
        "views": 0,
        "comments_num": 0,
        "create_time": 1638534090218,
        "update_time": 0,
        "page_id": "23017041032122368",
        "username": "user1",
        "user_avatar": "123456",
        "title": "大家好啊",
        "content": "今天也不错哦",
        "approve": ""
    }
}
```

### 5.4 修改帖子

- 请求路径：`/community/:page_id`
- 请求方法：POST
- 请求参数

| 参数名  | 参数类型 | 参数说明 | 备注                   |
| ------- | -------- | -------- | ---------------------- |
| content | string   | 正文     | 修改后的内容，不能为空 |

- 响应参数

| 参数名       | 参数类型 | 参数说明 | 备注                                    |
| ------------ | -------- | -------- | --------------------------------------- |
| views        | int      | 浏览数   |                                         |
| comments_num | int      | 评论数   |                                         |
| page_id      | string   | 帖子的id |                                         |
| username     | string   | 用户名   |                                         |
| user_avatar  | string   | 用户头像 |                                         |
| title        | string   | 帖子标题 |                                         |
| content      | string   | 帖子内容 |                                         |
| approve      | string   | 点赞者   | 用 `,` 分隔的用户名，表示这些人都点了赞 |
| create_time  | int      | 创建日期 | 时间戳                                  |
| update_time  | int      | 修改日期 | 时间戳                                  |

- 响应数据示例

```json
{
    "status": 200,
    "msg": "请求成功",
    "data": {
        "views": 1,
        "comments_num": 0,
        "create_time": 1638534090218,
        "update_time": 1638534339436,
        "page_id": "23017041032122368",
        "username": "user1",
        "user_avatar": "123456",
        "title": "大家好啊",
        "content": "very good",
        "approve": ""
    }
}
```

### 5.5 帖子点赞/取消点赞

- 请求路径：`/community/:page_id/approve`
- 请求方法：POST
- 请求参数

| 参数名 | 参数类型 | 参数说明   | 备注                                        |
| ------ | -------- | ---------- | ------------------------------------------- |
| add    | bool     | 是否是点赞 | true 表示点赞，false 表示取消点赞，不能为空 |

- 响应参数

	无

### 5.6 获取帖子评论列表

- 请求路径：`/community/:page_id/comments`
- 请求方法：POST
- 请求参数

| 参数名  | 参数类型 | 参数说明       | 备注                                 |
| ------- | -------- | -------------- | ------------------------------------ |
| start   | int      | 第几条评论开始 | 初始为1，不能为空                    |
| length  | int      | 获得的评论条数 | 不能大于20，不能为空                 |
| reverse | bool     | 是否倒序       | true表示返回的评论由新到旧，不能为空 |

- 响应参数

| 参数名      | 参数类型 | 参数说明             | 备注                                                         |
| ----------- | -------- | -------------------- | ------------------------------------------------------------ |
| id          | int      | 该条评论的id         |                                                              |
| create_time | int      | 评论事件             | 时间戳                                                       |
| content     | string   | 评论的内容           |                                                              |
| approve     | string   | 该条评论的点赞者     | 用 `,` 分隔的用户名，表示这些人都点了赞                      |
| reply       | string   | 该校评论下的所有回复 | 用 `` ``` `` 分隔每条回复，每条回复不同部分用 `` ` `` 分隔，结构是  `` ```username`userAvatar`targetName`content`` |
| username    | string   | 发表评论的人的用户名 |                                                              |
| use_avatar  | string   | 发表评论的人的头像   |                                                              |

- 响应数据示例

```json
{
    "status": 200,
    "msg": "请求成功",
    "data": [
        {
            "id": "3",
            "content": "这可还行",
            "approve": "",
            "reply": "```user1`123456`user1`又是你，大水怪```user1`123456`user2`水啊水啊水",
            "username": "user1",
            "user_avatar": "123456"
        },
        {
            "id": "2",
            "content": "这可还行",
            "approve": "",
            "reply": "369123",
            "username": "user1",
            "user_avatar": "123456"
        },
        {
            "id": "1",
            "content": "这可还行",
            "approve": "",
            "reply": "",
            "username": "user1",
            "user_avatar": "123456"
        }
    ]
}
```

### 5.7 发表评论

- 请求路径：`/community/:page_id/comments/insert`
- 请求方法：POST
- 请求参数

| 参数名  | 参数类型 | 参数说明 | 备注     |
| ------- | -------- | -------- | -------- |
| content | string   | 评论内容 | 不能为空 |

- 响应参数

	无

### 5.8 发表回复

- 请求路径：`/community/:page_id/comments/reply`
- 请求方法：POST
- 请求参数

| 参数名      | 参数类型 | 参数说明           | 备注     |
| ----------- | -------- | ------------------ | -------- |
| comment_id  | string   | 回复所在评论的 id  | 不能为空 |
| target_name | string   | 被回复的人的用户名 | 不能为空 |
| content     | string   | 回复的内容         | 不能为空 |

- 响应参数

| 参数名 | 参数类型 | 参数说明         | 备注                                                         |
| ------ | -------- | ---------------- | ------------------------------------------------------------ |
| reply  | string   | 评论下的所有回复 | 用 `` ``` `` 分隔每条回复，每条回复不同部分用 `` ` `` 分隔，结构是  `` ```username`userAvatar`targetName`content`` |

- 响应数据示例

```json
{
    "status": 200,
    "msg": "请求成功",
    "data": {
        "reply": "```user1`123456`user1`又是你，大水怪```user1`123456`user2`水啊水啊水```user1`123456`user1`好无聊啊"
    }
}
```

### 5.9 评论点赞/取消点赞

- 请求路径：`/community/:page_id/comments/approve`

- 请求方法：POST

- 请求参数

| 参数名 | 参数类型 | 参数说明   | 备注                                        |
| ------ | -------- | ---------- | ------------------------------------------- |
| add    | bool     | 是否是点赞 | true 表示点赞，false 表示取消点赞，不能为空 |
| id     | int      | 评论 id    | 不能为空                                    |

- 响应参数

	无

